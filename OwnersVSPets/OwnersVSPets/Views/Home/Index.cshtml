<div class="page-header">
    <h1> All users </h1>
</div>
<div class="panel">
     <div class="form-inline">
        <div class="form-group">
            <div class="col-md-8">
                <input class="form-control" ng-model="ownerName" placeholder="Name" />
            </div>
        </div>
        <div class="form-group">
            <div class="col-md-offset-1 col-md-8">
                <button class="btn btn-default" ng-click="addOwner(ownerName)">Add</button>
            </div>
        </div>
    </div>
    <div>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Pets count</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="owner in owners">
                    <td>{{owner.Name}}</td>
                    <td>{{owner.PetsAmount}}</td>
                    <td> <input class="btn btn-default" type="button" value="Delete" data-ng-click="deleteOwner(owner.Name)" /> </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
@section Scripts { 
    <script>
        var opApp = angular.module('ownersPetsApp', []);
        opApp.controller("ownersPetsController", function ($scope, $http) {
            $scope.getOwners = function() {
                $http({ method: 'GET', url: 'api/values' }).
                    then(function success(response) {
                        console.log(response.data);
                        $scope.owners = response.data;
                    }, function error(response) {
                        console.log(response.data);
                    })
            };
            $scope.getOwners();
            $scope.addOwner = function (ownerName) {
                if (ownerName) {
                    $http({ method: 'PUT', url: 'api/values', params: { 'ownerName': ownerName } }).
                        then(function success(response) {
                            console.log(response.data);
                            $scope.owners = response.data;
                        }, function error(response) {
                            console.log(response.data);
                        })
                }    
            }
            $scope.deleteOwner = function (ownerName) {
                if (ownerName) {
                    $http({ method: 'DELETE', url: 'api/values', params: { 'ownerName': ownerName } }).
                        then(function success(response) {
                            console.log(response.data);
                            $scope.owners = response.data;
                        }, function error(response) {
                            console.log(response.data);
                        })
                }
            }
    });
    </script>
}
